<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Records - VaxBuddy</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
  <style>
    .record-section {
      margin-bottom: var(--spacing-xxl);
    }

    .record-list {
      list-style: none;
      padding: 0;
    }

    .record-item {
      background: var(--card-bg);
      border-radius: var(--radius-md);
      padding: var(--spacing-md);
      margin-bottom: var(--spacing-md);
      border: 1px solid #eee;
    }

    .label {
      font-weight: 600;
      color: var(--text-light);
      margin-right: 4px;
    }
  </style>
</head>

<body>

  <!-- Navbar -->
  <nav class="navbar">
    <div class="container navbar-container">
      <div class="logo">
        <a href="front.html" style="color: inherit; text-decoration: none;">ðŸ©º Vax<span>Buddy</span></a>
      </div>
      <div class="nav-links">
        <a href="front.html">Home</a>
        <a href="dashboard.html">Dashboard</a>
        <a href="records.html" class="active">Records</a>
      </div>
    </div>
  </nav>

  <div class="container section">
    <h1>System Records</h1>
    <p>Raw data view of all registered profiles and vaccinations.</p>

    <div class="record-section">
      <h3>ðŸ‘© Mother Records</h3>
      <ul id="mother-list" class="record-list"></ul>
    </div>

    <div class="record-section">
      <h3>ðŸ‘¶ Child Records</h3>
      <ul id="child-list" class="record-list"></ul>
    </div>

  </div>

  <script>
    // Load and display records from localStorage
    function loadRecords() {
      let children = [];
      try { children = JSON.parse(localStorage.getItem('children')) || []; } catch (e) { }

      let mothers = {};
      children.forEach(child => {
        let key = child.motherName + '|' + child.motherPhone + '|' + child.motherAdhaar;
        if (!mothers[key]) mothers[key] = { name: child.motherName, phone: child.motherPhone, adhaar: child.motherAdhaar };
      });

      // Mother Records
      const motherList = document.getElementById('mother-list');
      if (Object.keys(mothers).length === 0) {
        motherList.innerHTML = '<li class="text-center text-light">No mother records found.</li>';
      } else {
        motherList.innerHTML = Object.values(mothers).map(m => `
              <li class="record-item shadow-sm">
                  <div><span class='label'>Name:</span> <strong>${m.name}</strong></div>
                  <div><span class='label'>Phone:</span> ${m.phone}</div>
                  <div><span class='label'>Adhaar:</span> ${m.adhaar}</div>
              </li>
          `).join('');
      }

      // Child Records
      const childList = document.getElementById('child-list');
      if (children.length === 0) {
        childList.innerHTML = '<li class="text-center text-light">No child records found.</li>';
      } else {
        childList.innerHTML = children.map(c => `
              <li class="record-item shadow-sm">
                  <div style="margin-bottom: 8px;">
                      <span class='label'>Name:</span> <strong style="color: var(--primary-color); font-size: 1.1rem;">${c.name}</strong>
                      <span class="badge badge-secondary" style="margin-left:8px; font-size: 0.8rem; background: #eee; color: #555;">${c.gender}</span>
                  </div>
                  <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 8px;">
                      <div><span class='label'>DOB:</span> ${c.dob}</div>
                      <div><span class='label'>Mother:</span> ${c.motherName}</div>
                  </div>
                  
                  <details style="margin-top: 12px; border-top: 1px solid #eee; padding-top: 8px;">
                      <summary style="cursor: pointer; color: var(--primary-color); font-weight: 500;">View Vaccinations (${c.vaccines.length})</summary>
                      <ul style="margin-top: 8px; padding-left: 16px;">
                          ${c.vaccines.map(v => `
                              <li style="margin-bottom: 4px; font-size: 0.9rem;">
                                  <strong>${v.name}</strong> - Due: ${v.dueDate} <span class="badge ${v.status === 'completed' ? 'badge-completed' : (v.status === 'overdue' ? 'badge-overdue' : 'badge-upcoming')}">${v.status}</span>
                              </li>
                          `).join('')}
                      </ul>
                  </details>
              </li>
          `).join('');
      }
    }
    window.onload = loadRecords;
  </script>
</body>

</html>